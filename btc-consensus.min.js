!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.btcConsensus=t()}}(function(){var t;return function t(e,o,n){function r(s,i){if(!o[s]){if(!e[s]){var u="function"==typeof require&&require;if(!i&&u)return u(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=o[s]={exports:{}};e[s][0].call(d.exports,function(t){var o=e[s][1][t];return r(o?o:t)},d,d.exports,t,e,o,n)}return o[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,o,n){!function(e,r){"function"==typeof t&&t.amd?t([],r):"object"==typeof n?o.exports=r():e.returnExports=r()}(this,function(){function t(r,a){if("function"!=typeof a)throw new Error("Bad callback given: "+a);if(!r)throw new Error("No options given");var i=r.onResponse;if(r="string"==typeof r?{uri:r}:JSON.parse(JSON.stringify(r)),r.onResponse=i,r.verbose&&(t.log=n()),r.url&&(r.uri=r.url,delete r.url),!r.uri&&""!==r.uri)throw new Error("options.uri is a required argument");if("string"!=typeof r.uri)throw new Error("options.uri must be a string");for(var u=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<u.length;c++)if(r[u[c]])throw new Error("options."+u[c]+" is not supported");if(r.callback=a,r.method=r.method||"GET",r.headers=r.headers||{},r.body=r.body||null,r.timeout=r.timeout||t.DEFAULT_TIMEOUT,r.headers.host)throw new Error("Options.headers.host is not supported");r.json&&(r.headers.accept=r.headers.accept||"application/json","GET"!==r.method&&(r.headers["content-type"]="application/json"),"boolean"!=typeof r.json?r.body=JSON.stringify(r.json):"string"!=typeof r.body&&(r.body=JSON.stringify(r.body)));var d=function(t){var e=[];for(var o in t)t.hasOwnProperty(o)&&e.push(encodeURIComponent(o)+"="+encodeURIComponent(t[o]));return e.join("&")};if(r.qs){var f="string"==typeof r.qs?r.qs:d(r.qs);-1!==r.uri.indexOf("?")?r.uri=r.uri+"&"+f:r.uri=r.uri+"?"+f}var l=function(t){var e={};e.boundry="-------------------------------"+Math.floor(1e9*Math.random());var o=[];for(var n in t)t.hasOwnProperty(n)&&o.push("--"+e.boundry+'\nContent-Disposition: form-data; name="'+n+'"\n\n'+t[n]+"\n");return o.push("--"+e.boundry+"--"),e.body=o.join(""),e.length=e.body.length,e.type="multipart/form-data; boundary="+e.boundry,e};if(r.form){if("string"==typeof r.form)throw"form name unsupported";if("POST"===r.method){var p=(r.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(r.headers["content-type"]=p,p){case"application/x-www-form-urlencoded":r.body=d(r.form).replace(/%20/g,"+");break;case"multipart/form-data":var h=l(r.form);r.body=h.body,r.headers["content-type"]=h.type;break;default:throw new Error("unsupported encoding:"+p)}}}return r.onResponse=r.onResponse||o,r.onResponse===!0&&(r.onResponse=a,r.callback=o),!r.headers.authorization&&r.auth&&(r.headers.authorization="Basic "+s(r.auth.username+":"+r.auth.password)),e(r)}function e(e){function o(){f=!0;var o=new Error("ETIMEDOUT");return o.code="ETIMEDOUT",o.duration=e.timeout,t.log.error("Timeout",{id:d._id,milliseconds:e.timeout}),e.callback(o,d)}function n(o){if(f)return t.log.debug("Ignoring timed out state change",{state:d.readyState,id:d.id});if(t.log.debug("State change",{state:d.readyState,id:d.id,timed_out:f}),d.readyState===i.OPENED){t.log.debug("Request started",{id:d.id});for(var n in e.headers)d.setRequestHeader(n,e.headers[n])}else d.readyState===i.HEADERS_RECEIVED?r():d.readyState===i.LOADING?(r(),s()):d.readyState===i.DONE&&(r(),s(),u())}function r(){if(!v.response){if(v.response=!0,t.log.debug("Got response",{id:d.id,status:d.status}),clearTimeout(d.timeoutTimer),d.statusCode=d.status,l&&0==d.statusCode){var o=new Error("CORS request rejected: "+e.uri);return o.cors="rejected",v.loading=!0,v.end=!0,e.callback(o,d)}e.onResponse(null,d)}}function s(){v.loading||(v.loading=!0,t.log.debug("Response body loading",{id:d.id}))}function u(){if(!v.end){if(v.end=!0,t.log.debug("Request done",{id:d.id}),d.body=d.responseText,e.json)try{d.body=JSON.parse(d.responseText)}catch(t){return e.callback(t,d)}e.callback(null,d,d.body)}}var d=new i,f=!1,l=a(e.uri),p="withCredentials"in d;if(c+=1,d.seq_id=c,d.id=c+": "+e.method+" "+e.uri,d._id=d.id,l&&!p){var h=new Error("Browser does not support cross-origin request: "+e.uri);return h.cors="unsupported",e.callback(h,d)}d.timeoutTimer=setTimeout(o,e.timeout);var v={response:!1,loading:!1,end:!1};return d.onreadystatechange=n,d.open(e.method,e.uri,!0),l&&(d.withCredentials=!!e.withCredentials),d.send(e.body),d}function o(){}function n(){var t,e,n={},a=["trace","debug","info","warn","error"];for(e=0;e<a.length;e++)t=a[e],n[t]=o,"undefined"!=typeof console&&console&&console[t]&&(n[t]=r(console,t));return n}function r(t,e){function o(o,n){return"object"==typeof n&&(o+=" "+JSON.stringify(n)),t[e].call(t,o)}return o}function a(t){var e,o=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{e=location.href}catch(t){e=document.createElement("a"),e.href="",e=e.href}var n=o.exec(e.toLowerCase())||[],r=o.exec(t.toLowerCase()),a=!(!r||r[1]==n[1]&&r[2]==n[2]&&(r[3]||("http:"===r[1]?80:443))==(n[3]||("http:"===n[1]?80:443)));return a}function s(t){var e,o,n,r,a,s,i,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,f=0,l="",p=[];if(!t)return t;do e=t.charCodeAt(d++),o=t.charCodeAt(d++),n=t.charCodeAt(d++),u=e<<16|o<<8|n,r=u>>18&63,a=u>>12&63,s=u>>6&63,i=63&u,p[f++]=c.charAt(r)+c.charAt(a)+c.charAt(s)+c.charAt(i);while(d<t.length);switch(l=p.join(""),t.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l}var i=XMLHttpRequest;if(!i)throw new Error("missing XMLHttpRequest");t.log={trace:o,debug:o,info:o,warn:o,error:o};var u=18e4,c=0;t.withCredentials=!1,t.DEFAULT_TIMEOUT=u,t.defaults=function(e,o){var n=function(t){var o=function(o,n){o="string"==typeof o?{uri:o}:JSON.parse(JSON.stringify(o));for(var r in e)void 0===o[r]&&(o[r]=e[r]);return t(o,n)};return o},r=n(t);return r.get=n(t.get),r.post=n(t.post),r.put=n(t.put),r.head=n(t.head),r};var d=["get","put","post","head"];return d.forEach(function(e){var o=e.toUpperCase(),n=e.toLowerCase();t[n]=function(e){"string"==typeof e?e={method:o,uri:e}:(e=JSON.parse(JSON.stringify(e)),e.method=o);var n=[e].concat(Array.prototype.slice.apply(arguments,[1]));return t.apply(this,n)}}),t.couch=function(e,n){function r(t,e,o){if(t)return n(t,e,o);if((e.statusCode<200||e.statusCode>299)&&o.error){t=new Error("CouchDB error: "+(o.error.reason||o.error.error));for(var r in o)t[r]=o[r];return n(t,e,o)}return n(t,e,o)}"string"==typeof e&&(e={uri:e}),e.json=!0,e.body&&(e.json=e.body),delete e.body,n=n||o;var a=t(e,r);return a},t})},{}],2:[function(t,e,o){function n(t){var e=t[0];return s(e)?a(t):r(t)}function r(t){for(var e={},o=0;o<t.length;o++){var n=t[o];for(var r in n){r in e||(e[r]=[]);var a=n[r];e[r].push(a)}}var s={};for(var r in e){var u=e[r],a=i(u);s[r]=a}return s}function a(t){for(var e={},o=0;o<t.length;o++)for(var n=t[o],r=0;r<n.length;r++){r in e||(e[r]=[]);var a=n[r];e[r].push(a)}var s=[];for(var u in e){var c=e[u],a=i(c);s[u]=a}return s}function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){for(var e={},o=null,n=0,r=0;r<t.length;r++){var a=t[r];a in e||(e[a]=0),e[a]++,e[a]>n&&(n=e[a],o=a)}return o}e.exports.Blockchain=function(t,e){if(!t||!t.length)throw"new Blockchain requires sources input parameter";this.address=function(e,o){for(var r=[],a=0;a<t.length;a++)!function(a){var s=t[a];s.address(e,function(t,e){t?r[a]={}:r[a]=e;for(var s=0;s<r.length;s++)if("undefined"==typeof r[s])return;var i=n(r);o(null,i)})}(a)},this.utxos=function(e,o){for(var r=[],a=0;a<t.length;a++)!function(a){var s=t[a];s.utxos(e,function(t,e){t?r[a]={}:r[a]=e;for(var s=0;s<r.length;s++)if("undefined"==typeof r[s])return;var i=n(r);o(null,i)})}(a)}},e.exports.aggregate=n,e.exports.Sources={},e.exports.Sources.Blank=t("./sources/blank_source.js").Blank,e.exports.Sources.BlockchainDotInfo=t("./sources/blockchain_dot_info.js").BlockchainDotInfo,e.exports.Sources.BlockrDotIo=t("./sources/blockr_dot_io.js").BlockrDotIo,e.exports.Sources.Insight=t("./sources/insight.js").Insight},{"./sources/blank_source.js":3,"./sources/blockchain_dot_info.js":4,"./sources/blockr_dot_io.js":5,"./sources/insight.js":6}],3:[function(t,e,o){o.Blank=function(){this.address=function(t,e){var o={address:t,balance:0,balance_confirmed:0,balance_unconfirmed:0,is_valid:!0,total_received_gross:0,total_received_net:0,total_sent_gross:0,total_sent_net:0,tx_count:0};e(null,o)},this.utxos=function(t,e){var o=[{tx_id:"",tx_output:0,amount:0,confirmations:2},{tx_id:"",tx_output:0,amount:0,confirmations:1}];e(null,o)}}},{}],4:[function(t,e,o){var n=t("request");o.BlockchainDotInfo=function(){this.address=function(t,e){var o="https://blockchain.info/address/"+t+"?format=json";n.get({url:o,json:!0},function(o,n,r){o&&e(o),200!=n.statusCode&&handle("blockchain_dot_info statusCode: "+n.statusCode);var a={address:t,balance:r.final_balance,total_received_net:r.total_received,total_sent_net:r.total_sent,tx_count:r.n_tx};e(null,a)})},this.utxos=function(t,e){var o="https://blockchain.info/unspent?active="+t;n.get({url:o,json:!0},function(t,o,n){t&&e(t),200!=o.statusCode&&handle("blockchain_dot_info statusCode: "+o.statusCode);for(var r=[],a=0;a<n.unspent_outputs.length;a++){var s=n.unspent_outputs[a],i={tx_id:s.tx_hash,tx_output:s.tx_output_n,amount:s.value,confirmations:s.confirmations};r.push(i)}r.sort(function(t,e){return t.confirmations<e.confirmations}),e(null,r)})}}},{request:1}],5:[function(t,e,o){var n=t("request");o.BlockrDotIo=function(){this.address=function(t,e){var o="https://btc.blockr.io/api/v1/address/info/"+t;n.get({url:o,json:!0},function(o,n,r){o&&e(o),200!=n.statusCode&&handle("blockr_dot_io statusCode: "+n.statusCode);var a={address:t,balance:1e8*r.data.balance,is_valid:r.data.is_valid,total_received_net:1e8*r.data.totalreceived,tx_count:r.data.nb_txs};e(null,a)})},this.utxos=function(t,e){var o="https://btc.blockr.io/api/v1/address/unspent/"+t;n.get({url:o,json:!0},function(t,o,n){t&&e(t),200!=o.statusCode&&handle("blockr_dot_io statusCode: "+o.statusCode),"success"!=n.status&&handle("blockr_dot_io status: "+n.status);for(var r=[],a=0;a<n.data.unspent.length;a++){var s=n.data.unspent[a],i={tx_id:s.tx,tx_output:s.n,amount:1e8*parseFloat(s.amount),confirmations:s.confirmations};r.push(i)}r.sort(function(t,e){return t.confirmations<e.confirmations}),e(null,r)})}}},{request:1}],6:[function(t,e,o){var n=t("request");o.Insight=function(t){"undefined"==typeof t&&(t="https://insight.bitpay.com"),t=t.replace(/\/+$/g,""),this.address=function(e,o){var r=t+"/api/addr/"+e+"?noTxList=1&noCache=1";n.get({url:r,json:!0},function(t,n,r){t&&o(t),200!=n.statusCode&&handle("insight statusCode: "+n.statusCode);var a={address:e,balance:r.balanceSat,balance_unconfirmed:r.unconfirmedBalanceSat,total_received_gross:r.totalReceivedSat,total_sent_gross:r.totalSentSat,tx_count:r.txApperances};o(null,a)})},this.utxos=function(t,e){var o="https://insight.bitpay.com/api/addr/"+t+"/utxo?noCache=1";n.get({url:o,json:!0},function(t,o,n){t&&e(t),200!=o.statusCode&&handle("insight statusCode: "+o.statusCode);for(var r=[],a=0;a<n.length;a++){var s=n[a],i={tx_id:s.txid,tx_output:s.vout,amount:1e8*s.amount,confirmations:s.confirmations};r.push(i)}r.sort(function(t,e){return t.confirmations<e.confirmations}),e(null,r)})}}},{request:1}]},{},[2])(2)});