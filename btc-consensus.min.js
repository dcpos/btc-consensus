!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o;o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,o.btcConsensus=t()}}(function(){var t;return function t(o,e,n){function r(a,i){if(!e[a]){if(!o[a]){var u="function"==typeof require&&require;if(!i&&u)return u(a,!0);if(s)return s(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var c=e[a]={exports:{}};o[a][0].call(c.exports,function(t){var e=o[a][1][t];return r(e?e:t)},c,c.exports,t,o,e,n)}return e[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(o,e,n){!function(o,r){"function"==typeof t&&t.amd?t([],r):"object"==typeof n?e.exports=r():o.returnExports=r()}(this,function(){function t(r,s){if("function"!=typeof s)throw new Error("Bad callback given: "+s);if(!r)throw new Error("No options given");var i=r.onResponse;if(r="string"==typeof r?{uri:r}:JSON.parse(JSON.stringify(r)),r.onResponse=i,r.verbose&&(t.log=n()),r.url&&(r.uri=r.url,delete r.url),!r.uri&&""!==r.uri)throw new Error("options.uri is a required argument");if("string"!=typeof r.uri)throw new Error("options.uri must be a string");for(var u=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],d=0;d<u.length;d++)if(r[u[d]])throw new Error("options."+u[d]+" is not supported");if(r.callback=s,r.method=r.method||"GET",r.headers=r.headers||{},r.body=r.body||null,r.timeout=r.timeout||t.DEFAULT_TIMEOUT,r.headers.host)throw new Error("Options.headers.host is not supported");r.json&&(r.headers.accept=r.headers.accept||"application/json","GET"!==r.method&&(r.headers["content-type"]="application/json"),"boolean"!=typeof r.json?r.body=JSON.stringify(r.json):"string"!=typeof r.body&&(r.body=JSON.stringify(r.body)));var c=function(t){var o=[];for(var e in t)t.hasOwnProperty(e)&&o.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return o.join("&")};if(r.qs){var f="string"==typeof r.qs?r.qs:c(r.qs);r.uri=-1!==r.uri.indexOf("?")?r.uri+"&"+f:r.uri+"?"+f}var l=function(t){var o={};o.boundry="-------------------------------"+Math.floor(1e9*Math.random());var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push("--"+o.boundry+'\nContent-Disposition: form-data; name="'+n+'"\n\n'+t[n]+"\n");return e.push("--"+o.boundry+"--"),o.body=e.join(""),o.length=o.body.length,o.type="multipart/form-data; boundary="+o.boundry,o};if(r.form){if("string"==typeof r.form)throw"form name unsupported";if("POST"===r.method){var p=(r.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(r.headers["content-type"]=p,p){case"application/x-www-form-urlencoded":r.body=c(r.form).replace(/%20/g,"+");break;case"multipart/form-data":var h=l(r.form);r.body=h.body,r.headers["content-type"]=h.type;break;default:throw new Error("unsupported encoding:"+p)}}}return r.onResponse=r.onResponse||e,r.onResponse===!0&&(r.onResponse=s,r.callback=e),!r.headers.authorization&&r.auth&&(r.headers.authorization="Basic "+a(r.auth.username+":"+r.auth.password)),o(r)}function o(o){function e(){f=!0;var e=new Error("ETIMEDOUT");return e.code="ETIMEDOUT",e.duration=o.timeout,t.log.error("Timeout",{id:c._id,milliseconds:o.timeout}),o.callback(e,c)}function n(){if(f)return t.log.debug("Ignoring timed out state change",{state:c.readyState,id:c.id});if(t.log.debug("State change",{state:c.readyState,id:c.id,timed_out:f}),c.readyState===i.OPENED){t.log.debug("Request started",{id:c.id});for(var e in o.headers)c.setRequestHeader(e,o.headers[e])}else c.readyState===i.HEADERS_RECEIVED?r():c.readyState===i.LOADING?(r(),a()):c.readyState===i.DONE&&(r(),a(),u())}function r(){if(!v.response){if(v.response=!0,t.log.debug("Got response",{id:c.id,status:c.status}),clearTimeout(c.timeoutTimer),c.statusCode=c.status,l&&0==c.statusCode){var e=new Error("CORS request rejected: "+o.uri);return e.cors="rejected",v.loading=!0,v.end=!0,o.callback(e,c)}o.onResponse(null,c)}}function a(){v.loading||(v.loading=!0,t.log.debug("Response body loading",{id:c.id}))}function u(){if(!v.end){if(v.end=!0,t.log.debug("Request done",{id:c.id}),c.body=c.responseText,o.json)try{c.body=JSON.parse(c.responseText)}catch(t){return o.callback(t,c)}o.callback(null,c,c.body)}}var c=new i,f=!1,l=s(o.uri),p="withCredentials"in c;if(d+=1,c.seq_id=d,c.id=d+": "+o.method+" "+o.uri,c._id=c.id,l&&!p){var h=new Error("Browser does not support cross-origin request: "+o.uri);return h.cors="unsupported",o.callback(h,c)}c.timeoutTimer=setTimeout(e,o.timeout);var v={response:!1,loading:!1,end:!1};return c.onreadystatechange=n,c.open(o.method,o.uri,!0),l&&(c.withCredentials=!!o.withCredentials),c.send(o.body),c}function e(){}function n(){var t,o,n={},s=["trace","debug","info","warn","error"];for(o=0;o<s.length;o++)t=s[o],n[t]=e,"undefined"!=typeof console&&console&&console[t]&&(n[t]=r(console,t));return n}function r(t,o){function e(e,n){return"object"==typeof n&&(e+=" "+JSON.stringify(n)),t[o].call(t,e)}return e}function s(t){var o,e=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{o=location.href}catch(t){o=document.createElement("a"),o.href="",o=o.href}var n=e.exec(o.toLowerCase())||[],r=e.exec(t.toLowerCase()),s=!(!r||r[1]==n[1]&&r[2]==n[2]&&(r[3]||("http:"===r[1]?80:443))==(n[3]||("http:"===n[1]?80:443)));return s}function a(t){var o,e,n,r,s,a,i,u,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,f=0,l="",p=[];if(!t)return t;do o=t.charCodeAt(c++),e=t.charCodeAt(c++),n=t.charCodeAt(c++),u=o<<16|e<<8|n,r=u>>18&63,s=u>>12&63,a=u>>6&63,i=63&u,p[f++]=d.charAt(r)+d.charAt(s)+d.charAt(a)+d.charAt(i);while(c<t.length);switch(l=p.join(""),t.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l}var i=XMLHttpRequest;if(!i)throw new Error("missing XMLHttpRequest");t.log={trace:e,debug:e,info:e,warn:e,error:e};var u=18e4,d=0;t.withCredentials=!1,t.DEFAULT_TIMEOUT=u,t.defaults=function(o){var e=function(t){var e=function(e,n){e="string"==typeof e?{uri:e}:JSON.parse(JSON.stringify(e));for(var r in o)void 0===e[r]&&(e[r]=o[r]);return t(e,n)};return e},n=e(t);return n.get=e(t.get),n.post=e(t.post),n.put=e(t.put),n.head=e(t.head),n};var c=["get","put","post","head"];return c.forEach(function(o){var e=o.toUpperCase(),n=o.toLowerCase();t[n]=function(o){"string"==typeof o?o={method:e,uri:o}:(o=JSON.parse(JSON.stringify(o)),o.method=e);var n=[o].concat(Array.prototype.slice.apply(arguments,[1]));return t.apply(this,n)}}),t.couch=function(o,n){function r(t,o,e){if(t)return n(t,o,e);if((o.statusCode<200||o.statusCode>299)&&e.error){t=new Error("CouchDB error: "+(e.error.reason||e.error.error));for(var r in e)t[r]=e[r];return n(t,o,e)}return n(t,o,e)}"string"==typeof o&&(o={uri:o}),o.json=!0,o.body&&(o.json=o.body),delete o.body,n=n||e;var s=t(o,r);return s},t})},{}],2:[function(t,o){function e(t){var o=t[0];return s(o)?r(t):n(t)}function n(t){for(var o={},e=0;e<t.length;e++){var n=t[e];for(var r in n){r in o||(o[r]=[]);var s=n[r];o[r].push(s)}}var i={};for(var r in o){var u=o[r],s=a(u);i[r]=s}return i}function r(t){var o=[];t.sort(function(t,o){return t.length<o.length});for(var e={},n=t[0],r=0;r<n.length;r++){var s=n[r],a=JSON.stringify(s);a in e||(o.push(s),e[a]=!0);var i=1;1!=n.length&&(i=r/(n.length-1));for(var u=1;u<t.length;u++){var d=t[u],c=i*(d.length-1),f=Math.floor(c),s=d[f],a=JSON.stringify(s);a in e||(o.push(s),e[a]=!0)}}return o}function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function a(t){for(var o={},e=null,n=0,r=0;r<t.length;r++){var s=t[r];s in o||(o[s]=0),o[s]++,o[s]>n&&(n=o[s],e=s)}return e}o.exports.Blockchain=function(t){if(!t||!t.length)throw"new Blockchain requires sources input parameter";this.address=function(o,n){for(var r=[],s=0;s<t.length;s++)!function(s){var a=t[s];a.address(o,function(t,o){r[s]=t?{}:o;for(var a=0;a<r.length;a++)if("undefined"==typeof r[a])return;var i=e(r);n(null,i)})}(s)},this.utxos=function(o,n){for(var r=[],s=0;s<t.length;s++)!function(s){var a=t[s];a.utxos(o,function(t,o){r[s]=t?{}:o;for(var a=0;a<r.length;a++)if("undefined"==typeof r[a])return;var i=e(r);n(null,i)})}(s)},this.txs=function(o,n){for(var r=[],s=0;s<t.length;s++)!function(s){var a=t[s];a.txs(o,function(t,o){r[s]=t?{}:o;for(var a=0;a<r.length;a++)if("undefined"==typeof r[a])return;var i=e(r);n(null,i)})}(s)},this.tx=function(o,n){for(var r=[],s=0;s<t.length;s++)!function(s){var a=t[s];a.tx(o,function(t,o){r[s]=t?{}:o;for(var a=0;a<r.length;a++)if("undefined"==typeof r[a])return;var i=e(r);n(null,i)})}(s)}},o.exports.aggregate=e,o.exports.Sources={},o.exports.Sources.Blank=t("./sources/blank_source.js").Blank,o.exports.Sources.BlockchainDotInfo=t("./sources/blockchain_dot_info.js").BlockchainDotInfo,o.exports.Sources.BlockrDotIo=t("./sources/blockr_dot_io.js").BlockrDotIo,o.exports.Sources.Insight=t("./sources/insight.js").Insight},{"./sources/blank_source.js":3,"./sources/blockchain_dot_info.js":4,"./sources/blockr_dot_io.js":5,"./sources/insight.js":6}],3:[function(t,o,e){e.Blank=function(){this.address=function(t,o){var e={address:t,balance:0,balance_confirmed:0,balance_unconfirmed:0,is_valid:!0,total_received_gross:0,total_received_net:0,total_sent_gross:0,total_sent_net:0,tx_count:0};o(null,e)},this.utxos=function(t,o){var e=[{txid:"",tx_output:0,amount:0,confirmations:2},{txid:"",tx_output:0,amount:0,confirmations:1}];o(null,e)},this.txs=function(t,o){var e=["oldest_tx_hash","newest_tx_hash"];o(null,e)},this.tx=function(t,o){var e={block_height:0,block_time:0,lock_time:0,txid:t,fee:0,inputs:[{address:"",txid:"",amount:0,tx_output:0}],outputs:[{address:"",amount:0}]};o(null,e)}}},{}],4:[function(t,o,e){var n=t("request");e.BlockchainDotInfo=function(){var t=this;this.address=function(t,o){var e="https://blockchain.info/address/"+t+"?format=json";n.get({url:e,json:!0},function(e,n,r){e&&o(e),200!=n.statusCode&&o("blockchain_dot_info statusCode: "+n.statusCode);var s={address:t,balance:r.final_balance,total_received_net:r.total_received,total_sent_net:r.total_sent,tx_count:r.n_tx};o(null,s)})},this.utxos=function(t,o){var e="https://blockchain.info/unspent?active="+t;n.get({url:e,json:!0},function(t,e,n){t&&o(t),200!=e.statusCode&&o("blockchain_dot_info statusCode: "+e.statusCode);for(var r=[],s=0;s<n.unspent_outputs.length;s++){var a=n.unspent_outputs[s],i={txid:a.tx_hash,tx_output:a.tx_output_n,amount:a.value,confirmations:a.confirmations};r.push(i)}r.sort(function(t,o){return t.confirmations<o.confirmations}),o(null,r)})},this.txs=function(o,e,r,s){var a=1e5,i=50,u="https://blockchain.info/address/"+o+"?format=json";r?u=u+"&offset="+r:r=0,s||(s=[]),n.get({url:u,json:!0},function(n,u,d){n&&e(n),200!=u.statusCode&&e("blockchain_dot_info statusCode: "+u.statusCode);var c=d.txs.map(function(t){return t.hash}),f=c.reverse();s=f.concat(s);var l=s.length>=d.n_tx,p=a>r;if(!l&&p){var h=r+i;t.txs(o,e,h,s)}else e(null,s)})},this.tx=function(t,o){var e="https://blockchain.info/tx/"+t+"?format=json";n.get({url:e,json:!0},function(t,e,n){t&&o(t),200!=e.statusCode&&o("blockchain_dot_info statusCode: "+e.statusCode);var r={block_height:n.block_height,lock_time:n.lock_time,txid:n.hash,inputs:[],outputs:[]};r.inputs=n.inputs.map(function(t){return{address:t.prev_out.addr,amount:t.prev_out.value,tx_output:t.prev_out.n}}),r.outputs=n.out.map(function(t){return{address:t.addr,amount:t.value}});for(var s=0,a=0;a<r.inputs.length;a++)s+=r.inputs[a].amount;for(var i=0,a=0;a<r.outputs.length;a++)i+=r.outputs[a].amount;r.fee=s-i,o(null,r)})}}},{request:1}],5:[function(t,o,e){var n=t("request");e.BlockrDotIo=function(){function t(t){var o=parseFloat(t),e=Math.round(1e8*o),n=Math.abs(e);return n}this.address=function(t,o){var e="https://btc.blockr.io/api/v1/address/info/"+t;n.get({url:e,json:!0},function(e,n,r){e&&o(e),200!=n.statusCode&&o("blockr_dot_io statusCode: "+n.statusCode);var s={address:t,balance_confirmed:1e8*r.data.balance,is_valid:r.data.is_valid,total_received_net:1e8*r.data.totalreceived,tx_count:r.data.nb_txs};o(null,s)})},this.utxos=function(o,e){var r="https://btc.blockr.io/api/v1/address/unspent/"+o;n.get({url:r,json:!0},function(o,n,r){o&&e(o),200!=n.statusCode&&e("blockr_dot_io statusCode: "+n.statusCode),"success"!=r.status&&e("blockr_dot_io status: "+r.status);for(var s=[],a=0;a<r.data.unspent.length;a++){var i=r.data.unspent[a],u={txid:i.tx,tx_output:i.n,amount:t(i.amount),confirmations:i.confirmations};s.push(u)}s.sort(function(t,o){return t.confirmations<o.confirmations}),e(null,s)})},this.txs=function(t,o){var e="https://btc.blockr.io/api/v1/address/txs/"+t;n.get({url:e,json:!0},function(t,e,n){t&&o(t),200!=e.statusCode&&o("blockr_dot_io statusCode: "+e.statusCode);var r=n.data.txs.map(function(t){return t.tx}),s=r.reverse();o(null,s)})},this.tx=function(o,e){var r="https://btc.blockr.io/api/v1/tx/info/"+o;n.get({url:r,json:!0},function(o,n,r){o&&e(o),200!=n.statusCode&&e("blockr_dot_io statusCode: "+n.statusCode);var s={block_height:r.data.block,block_time:new Date(r.data.time_utc).getTime()/1e3,txid:r.data.tx,fee:t(r.data.fee),inputs:[],outputs:[]};s.inputs=r.data.vins.map(function(o){return{address:o.address,txid:o.vout_tx,amount:t(o.amount),tx_output:o.n}}),s.outputs=r.data.vouts.map(function(o){return{address:o.address,amount:t(o.amount)}}),e(null,s)})}}},{request:1}],6:[function(t,o,e){var n=t("request");e.Insight=function(t){function o(t){var o=parseFloat(t),e=Math.round(1e8*o),n=Math.abs(e);return n}"undefined"==typeof t&&(t="https://insight.bitpay.com"),t=t.replace(/\/+$/g,""),this.address=function(o,e){var r=t+"/api/addr/"+o+"?noTxList=1&noCache=1";n.get({url:r,json:!0},function(t,n,r){t&&e(t),200!=n.statusCode&&e("insight statusCode: "+n.statusCode);var s={address:o,balance:r.balanceSat+r.unconfirmedBalanceSat,balance_confirmed:r.balanceSat,balance_unconfirmed:r.unconfirmedBalanceSat,total_received_gross:r.totalReceivedSat,total_sent_gross:r.totalSentSat,tx_count:r.txApperances};e(null,s)})},this.utxos=function(t,o){var e="https://insight.bitpay.com/api/addr/"+t+"/utxo?noCache=1";n.get({url:e,json:!0},function(t,e,n){t&&o(t),200!=e.statusCode&&o("insight statusCode: "+e.statusCode);for(var r=[],s=0;s<n.length;s++){var a=n[s],i={txid:a.txid,tx_output:a.vout,amount:1e8*a.amount,confirmations:a.confirmations};r.push(i)}r.sort(function(t,o){return t.confirmations<o.confirmations}),o(null,r)})},this.txs=function(o,e){var r=t+"/api/txs/?address="+o;n.get({url:r,json:!0},function(t,o,n){t&&e(t),200!=o.statusCode&&e("insight statusCode: "+o.statusCode);var r=n.txs.map(function(t){return t.txid}),s=r.reverse();e(null,s)})},this.tx=function(e,r){var s=t+"/api/tx/"+e;n.get({url:s,json:!0},function(t,e,n){t&&r(t),200!=e.statusCode&&r("insight statusCode: "+e.statusCode);var s={block_time:n.time,lock_time:n.locktime,txid:n.txid,fee:o(n.fees),inputs:[],outputs:[]};s.inputs=n.vin.map(function(t){return{address:t.addr,txid:t.txid,amount:t.valueSat,tx_output:t.vout}}),s.outputs=n.vout.map(function(t){return{address:t.scriptPubKey.addresses[0],amount:o(t.value)}}),r(null,s)})}}},{request:1}]},{},[2])(2)});